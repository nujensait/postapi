
( [README НА АНГЛИЙСКОМ](README.ENG.MD) )
( [ТЕСТЫ](tests/README.md) )

---

## Содержание

- [Что это?](#что-это)
- [Задача](#задача)
  - [Дополнительные условия](#дополнительные-условия)
  - [Результат](#результат)
  - [Оценка результата (основные критерии)](#оценка-результата-основные-критерии)
- [Установка](#установка)
  - [Вариант 1: Установка через скрипт (рекомендуется)](#вариант-1-установка-через-скрипт-рекомендуется)
  - [Вариант 2: Установка вручную](#вариант-2-установка-вручную)
  - [Запуск приложения](#запуск-приложения)
- [Справка по API](#справка-по-api)
- [Автоматизированные тесты](#автоматизированные-тесты)
- [Ручная проверка](#ручная-проверка)
- [Нужны доработки](#нужны-доработки)

---

## Что это?
Задача с хакатон "Express CRUD", за 08.05.2024

В рамках хакатона участникам предлагается
реализовать CRUD API, позволяющее пользователям
манипулировать постами

## Задача
Реализовать решение следующей задачи на Nodejs.

Нужно реализовать CRUD API, позволяющее пользователям манипулировать постами.

Требуется реализация API на Nodejs, которое позволяет:
- Зарегистрировать и аутентифицировать пользователя
- Регулировать права пользователя (спектр возможностей при манипуляции с постами)
- Создавать зарегистрированному пользователю новые посты с описанием
- Просматривать посты незарегистрированному пользователю
- Удалять и изменять посты пользователю, обладающему достаточными правами
- Удалять или изменять посты пользователю, являющимся автором поста

### Дополнительные условия
Выполнившим основные условия участникам
предлагается реализовать дополнительные возможности,
приносящих бонусные очки:
- Возможность лайкать посты
- Возможность банить пользователей при наличии
определённых прав
- Возможность оставлять комментарии
Обратите внимание:
- Дополнительные условия являются опциональными;
- Допускается произвольный порядок выполнения
дополнительных условий;
- Выполнение дополнительных условий не
засчитывается без выполнения всех пунктов основного
условия.

### Результат
Необходимо представить коллекцию в Postman с
запросами, реализующими функционал, описанный в
задании. 

Также необходимо выложить код проекта в
публичный репозиторий

### Оценка результата (основные критерии)
- Полнота решения
- Качество организации кода
- Корректность использования тех или иных подходов
для организации API

----

## Установка

### Вариант 1: Установка через скрипт (рекомендуется)
```bash
# Для Windows
scripts\install-dependencies.bat

# Для Linux/Mac
chmod +x scripts/install-dependencies.sh
./scripts/install-dependencies.sh
```

### Вариант 2: Установка вручную
```bash
# установить все зависимости из package.json
npm install

# или установить вручную (версии см. в dependencies.txt)
npm install express sqlite3 bcryptjs jsonwebtoken
npm install --save-dev jest supertest nodemon
```

Все необходимые зависимости перечислены в файле [dependencies.txt](dependencies.txt)

### Запуск приложения
```bash
# run app
npm run dev

# run migrations
node .\db\database.js

```

## Справка по API

Для получения справки по доступным API методам откройте в браузере или выполните GET запрос:

```
GET http://localhost:3005/
```

Ответ будет содержать:
- Приветственное сообщение
- Версию API
- Список всех доступных endpoints с описанием
- Информацию о требованиях к авторизации
- Примеры использования

## Автоматизированные тесты

Запуск автоматизированных тестов API:
```bash
# запустить все тесты
npm test

# запустить тесты в режиме наблюдения
npm run test:watch

# запустить тесты с отчетом о покрытии кода
npm test -- --coverage
```

Подробнее о тестах см. [tests/README.md](tests/README.md).

## Ручная проверка

Загрузить (импортировать) данные из файла: [postman.json](postman.json)

Или запустите отдельные запросы Postman:

```
# auth
URL: http://localhost:3005/auth/login
Method: POST
Headers: Content-Type: application/json
Body (raw JSON):
{
  "username": "newuser",
  "password": "password123"
}

# create post
URL: http://localhost:3005/posts
Method: POST
Headers:
  Content-Type: application/json
  Authorization: Bearer [Token]  // Замените [Token] на токен, полученный при аутентификации
Body (raw JSON):
{
  "title": "New Post Title",
  "description": "Description of the new post."
}

# get posts
URL: http://localhost:3005/posts
Method: GET
Headers: None

# update post
URL: http://localhost:3005/posts/1  // Замените '1' на ID поста, который вы хотите обновить
Method: PUT
Headers:
  Content-Type: application/json
  Authorization: Bearer [Token]
Body (raw JSON):
{
  "title": "Updated Post Title",
  "description": "Updated description of the post."
}

# delete post
URL: http://localhost:3005/posts/1  // Замените '1' на ID поста, который вы хотите удалить
Method: DELETE
Headers:
  Authorization: Bearer [Token]
```

## Нужны доработки 
- использовать authMiddleware для операций CRUD сообщений (теперь аутентификация здесь пропускается)
- исправлена ошибка при регистрации/авторизации (сейчас не работает)