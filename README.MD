
( [README НА АНГЛИЙСКОМ](README.ENG.MD) )
( [ТЕСТЫ](tests/README.md) )
( [ПРОДАКШЕН](PRODUCTION.MD) )

---

## Содержание

- [Что это?](#что-это)
- [Задача](#задача)
  - [Дополнительные условия](#дополнительные-условия)
  - [Результат](#результат)
  - [Оценка результата (основные критерии)](#оценка-результата-основные-критерии)
- [Установка](#установка)
  - [Вариант 1: Установка через скрипт (рекомендуется)](#вариант-1-установка-через-скрипт-рекомендуется)
  - [Вариант 2: Установка вручную](#вариант-2-установка-вручную)
  - [Запуск приложения](#запуск-приложения)
- [Справка по API](#справка-по-api)
- [Автоматизированные тесты](#автоматизированные-тесты)
- [Ручная проверка](#ручная-проверка)
- [Контакты](#контакты)

---

## Что это?
Задача с хакатон "Express CRUD", за 08.05.2024

В рамках хакатона участникам предлагается
реализовать CRUD API, позволяющее пользователям
манипулировать постами

## Задача
Реализовать решение следующей задачи на Nodejs.

Нужно реализовать CRUD API, позволяющее пользователям манипулировать постами.

Требуется реализация API на Nodejs, которое позволяет:
- Зарегистрировать и аутентифицировать пользователя
- Регулировать права пользователя (спектр возможностей при манипуляции с постами)
- Создавать зарегистрированному пользователю новые посты с описанием
- Просматривать посты незарегистрированному пользователю
- Удалять и изменять посты пользователю, обладающему достаточными правами
- Удалять или изменять посты пользователю, являющимся автором поста

### Дополнительные условия
Выполнившим основные условия участникам
предлагается реализовать дополнительные возможности,
приносящих бонусные очки:
- Возможность лайкать посты
- Возможность банить пользователей при наличии
определённых прав
- Возможность оставлять комментарии
Обратите внимание:
- Дополнительные условия являются опциональными;
- Допускается произвольный порядок выполнения
дополнительных условий;
- Выполнение дополнительных условий не
засчитывается без выполнения всех пунктов основного
условия.

### Результат
Необходимо представить коллекцию в Postman с
запросами, реализующими функционал, описанный в
задании. 

Также необходимо выложить код проекта в
публичный репозиторий

### Оценка результата (основные критерии)
- Полнота решения
- Качество организации кода
- Корректность использования тех или иных подходов
для организации API

----

## Установка

### Вариант 1: Установка через скрипт (рекомендуется)
```bash
# Для Windows
scripts\install-dependencies.bat

# Для Linux/Mac
chmod +x scripts/install-dependencies.sh
./scripts/install-dependencies.sh
```

### Вариант 2: Установка вручную
```bash
# установить все зависимости из package.json
npm install

# или установить вручную (версии см. в dependencies.txt)
npm install express sqlite3 bcryptjs jsonwebtoken
npm install --save-dev jest supertest nodemon
```

Все необходимые зависимости перечислены в файле [dependencies.txt](dependencies.txt)

### Настройка переменных окружения

Скопируйте `.env.example` в `.env` и настройте переменные:

```bash
cp .env.example .env
nano .env
```

**Основные переменные:**
- `API_URL` - URL для Swagger (например: `http://90.156.202.37:3005`)
- `PORT` - Порт приложения (по умолчанию: `3005`)
- `NODE_ENV` - Режим окружения (`development` или `production`)
- `JWT_SECRET` - Секретный ключ для JWT (обязательно измените на продакшене!)

Подробнее: [PRODUCTION.MD - Настройка переменных окружения](PRODUCTION.MD#настройка-переменных-окружения)

### Запуск приложения

**Использование Makefile (рекомендуется):**
```bash
# Показать все доступные команды
make help

# Установить зависимости
make install

# Запустить в режиме разработки
make dev

# Запустить в фоне (nohup)
make nohup-start

# Запустить в screen
make screen-start

# Инициализировать базу данных
make db-init

# Запустить тесты
make test
```

**Режим разработки:**
```bash
# run app with nodemon (auto-reload)
npm run dev
# или
make dev

# run migrations
node .\db\database.js
# или
make db-init
```

**Режим продакшена (фоновый запуск):**
```bash
# Запуск в фоне с nohup
make nohup-start

# Остановка
make nohup-stop

# Просмотр логов
make logs

# Запуск в screen (рекомендуется)
make screen-start

# Подключиться к screen сессии
make screen-attach

# Остановка screen
make prod-stop

# Статус приложения
make status
```

Подробная документация по запуску на продакшене: [PRODUCTION.MD](PRODUCTION.MD)

```

## Справка по API

### Swagger UI (интерактивная документация)

Для доступа к полной интерактивной документации API откройте в браузере:

```
http://localhost:3005/
```

или напрямую:

```
http://localhost:3005/api-docs
```

Swagger UI предоставляет:
- Полное описание всех endpoints
- Интерактивное тестирование API прямо в браузере
- Схемы данных и примеры запросов/ответов
- Возможность авторизации и выполнения запросов

**Примечание:** Корневой адрес `/` автоматически перенаправляет на `/api-docs`

## Автоматизированные тесты

Запуск автоматизированных тестов API:
```bash
# запустить все тесты
npm test

# запустить тесты в режиме наблюдения
npm run test:watch

# запустить тесты с отчетом о покрытии кода
npm test -- --coverage
```

Подробнее о тестах см. [tests/README.md](tests/README.md).

## Ручная проверка

Загрузить (импортировать) данные из файла: [tests/postman.json](tests/postman.json)

## Контакты

Mikhail Ikonnikov <mishaikon@gmail.com>